<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Auto M3U8 & Iframe Player</title>
<style>
  body {
    background: #000;
    color: #0ff;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  h1 {
    margin-top: 15px;
    font-weight: 700;
    text-shadow: 0 0 8px #00ffc3;
  }
  #playerBox {
    width: 100%;
    max-width: 900px;
    height: 480px;
    margin: 20px auto;
    border-radius: 12px;
    border: 2px solid #00ffc3;
    box-shadow: 0 0 15px #00ffc3;
    background: #111;
    overflow: hidden;
  }
  iframe, video {
    width: 100%;
    height: 100%;
    border-radius: 12px;
    background: black;
  }
  #controls {
    max-width: 900px;
    width: 100%;
    margin: 10px auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    padding: 0 10px;
  }
  #volumeControl {
    flex-grow: 1;
    max-width: 200px;
  }
  button {
    background: #00ffc3;
    border: none;
    color: #000;
    font-weight: 600;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #00b38a;
    color: #fff;
  }
  #channelList {
    max-width: 900px;
    width: 100%;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    padding: 10px;
  }
  .channelBtn {
    background: #005f4d;
    border: 2px solid #00ffc3;
    border-radius: 8px;
    color: #0ff;
    font-weight: 600;
    padding: 8px 16px;
    cursor: pointer;
    flex: 1 1 140px;
    text-align: center;
    user-select: none;
    transition: background 0.3s ease, color 0.3s ease;
  }
  .channelBtn:hover, .channelBtn.active {
    background: #00ffc3;
    color: #000;
  }
  @media (max-width: 600px) {
    #playerBox {
      height: 260px;
    }
  }
</style>
</head>
<body>

<h1>M3U8 & Iframe Auto Player</h1>

<div id="playerBox">
  <!-- Video or iframe player will be loaded here -->
</div>

<div id="controls">
  <label for="volumeControl">Volume</label>
  <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="0.7" />
  <button id="recordBtn">Start Recording</button>
</div>

<div id="channelList">
  <!-- Channel buttons auto generated here -->
</div>

<script>
  // Channels array: each subarray = different servers for 1 channel
  // Put URLs as you want, iframe/html URLs or .m3u8 direct streams
  const channels = [
    ["https://amitb3669.github.io/allinonereborn/str_sports_hindi.html", "https://watch.dtvxtream.com/lunar-ipl-hindi", "https://momixtvmpdplayer.pages.dev/?play=https://ottb.live.cf.ww.aiv-cdn.net/lhr-nitro/live/clients/dash/enc/qoumyhlpal/out/v1/3cd34e92a4e64d239c73eaad0637b094/cenc.mpd&kid=2306a99f3da0dd901a5e5ab547c1a7d1&key=6c1c0c2b7d29b6ab1bfaa62e0fc30728"],
    ["https://allinonereborn.com/spicetv-web/player.html?url=https%3A%2F%2Fallinonereborn.com%2Ftest.m3u8%3Fid%3D65088&name=WILLOW%20HD", "https://amssandbrix.b-cdn.net/LiveApp/streams/NKAv2V2BTnEuVJdS170390248731.m3u8"],
    ["https://allinonereborn.com/spicetv-web/player.html?url=https%3A%2F%2Fallinonereborn.com%2Ftest.m3u8%3Fid%3D44598&name=MLB%20NETWORK%20HD", "https://watch.dtvxtream.com/lunar-ipl-eng"]
  ];

  let currentChannelIndex = 0;
  let currentServerIndex = 0;
  let isRecording = false;
  let recordStartTime = null;

  const playerBox = document.getElementById("playerBox");
  const volumeControl = document.getElementById("volumeControl");
  const recordBtn = document.getElementById("recordBtn");
  const channelList = document.getElementById("channelList");

  // Initialize volume value
  volumeControl.value = 0.7;

  // Create channel buttons dynamically
  function createChannelButtons() {
    channelList.innerHTML = "";
    channels.forEach((servers, chIndex) => {
      const btn = document.createElement("button");
      btn.classList.add("channelBtn");
      btn.innerText = `Channel ${chIndex + 1}`;
      btn.title = servers[0];
      btn.onclick = () => loadChannel(chIndex);
      channelList.appendChild(btn);
    });
    setActiveChannelButton(currentChannelIndex);
  }

  // Highlight active channel button
  function setActiveChannelButton(index) {
    const buttons = document.querySelectorAll(".channelBtn");
    buttons.forEach((btn, i) => {
      btn.classList.toggle("active", i === index);
    });
  }

  // Load channel by index, default server 0
  function loadChannel(index) {
    currentChannelIndex = index;
    currentServerIndex = 0;
    setActiveChannelButton(index);
    loadStream(channels[index][0]);
  }

  // Load stream URL: decide iframe or video player
  function loadStream(url) {
    // Clear previous player
    playerBox.innerHTML = "";

    if (!url) {
      playerBox.innerText = "No stream URL available.";
      return;
    }

    // Determine if URL is iframe/html page or direct stream (.m3u8, .mp4 etc)
    const isIframe = url.includes(".html") || url.includes("player?") || url.includes("iframe") || url.includes("http") && url.match(/\.html?|player\?|iframe/);

    if (isIframe) {
      // iframe player
      const iframe = document.createElement("iframe");
      iframe.src = url;
      iframe.allowFullscreen = true;
      iframe.style.border = "none";
      iframe.style.width = "100%";
      iframe.style.height = "100%";
      iframe.style.borderRadius = "12px";
      playerBox.appendChild(iframe);
    } else {
      // video player for .m3u8 or direct streams
      const video = document.createElement("video");
      video.controls = true;
      video.autoplay = true;
      video.id = "mainPlayer";
      video.style.width = "100%";
      video.style.height = "100%";
      video.style.borderRadius = "12px";

      const source = document.createElement("source");
      source.src = url;
      source.type = "application/x-mpegURL";

      video.appendChild(source);
      playerBox.appendChild(video);

      // Sync volume slider and video volume
      video.volume = volumeControl.value;

      // Listen for volume slider changes
      volumeControl.oninput = () => {
        video.volume = volumeControl.value;
      };
    }
  }

  // Recording button logic (fake demo)
  recordBtn.onclick = () => {
    if (!isRecording) {
      isRecording = true;
      recordBtn.innerText = "Stop Recording";
      recordStartTime = new Date();
      alert("Recording started (demo only, not real)");
    } else {
      isRecording = false;
      recordBtn.innerText = "Start Recording";
      const duration = ((new Date()) - recordStartTime) / 1000;
      // Create fake blob file to download
      const blob = new Blob([`Fake recording of duration ${duration.toFixed(1)} seconds.`], {type: "video/mp4"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = `recording_${Date.now()}.mp4`;
      a.click();
      alert("Recording stopped and file downloaded (demo)");
    }
  };

  // Keyboard shortcuts
  document.addEventListener("keydown", (e) => {
    const video = document.getElementById("mainPlayer");
    if (!video) return;

    switch(e.code) {
      case "Space":
        e.preventDefault();
        if (video.paused) video.play(); else video.pause();
        break;
      case "ArrowRight":
        video.currentTime += 10;
        break;
      case "ArrowLeft":
        video.currentTime -= 10;
        break;
    }
  });

  // On page load
  window.onload = () => {
    createChannelButtons();
    loadChannel(0);
  };
</script>

</body>
</html>
