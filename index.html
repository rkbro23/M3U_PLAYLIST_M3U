<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ultimate IPTV Player</title>
  <script type="module" src="https://cdn.jsdelivr.net/npm/hls-video-element/+esm"></script>
  <script type="module" src="https://cdn.jsdelivr.net/npm/player.style/yt/+esm"></script>
  <style>
    :root {
      --bg: #0f0f0f;
      --text: #fff;
      --primary: #1db954;
      --accent: #00ffe7;
    }
    [data-theme='light'] {
      --bg: #ffffff;
      --text: #000000;
      --primary: #007bff;
      --accent: #00bcd4;
    }body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: var(--bg);
  color: var(--text);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  transition: all 0.3s ease;
}

h1 {
  background: linear-gradient(to right, var(--accent), var(--primary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-size: 2rem;
  margin-bottom: 20px;
  animation: fadeInDown 1s ease-in-out;
}

.controls {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin-bottom: 20px;
}

input, select, button, label {
  padding: 10px;
  border-radius: 10px;
  border: none;
  font-size: 1rem;
  background: #1b1b1b;
  color: var(--accent);
  outline: none;
  transition: all 0.3s;
}

input[type="file"] {
  color: white;
}

button {
  cursor: pointer;
  background: var(--primary);
  color: white;
}

button:hover {
  background: var(--accent);
  color: #000;
}

media-theme-yt, video {
  width: 100%;
  max-width: 900px;
  aspect-ratio: 16 / 9;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0, 255, 231, 0.4);
  margin-top: 10px;
}

#playlist {
  margin-top: 20px;
  background: rgba(255, 255, 255, 0.05);
  padding: 10px;
  border-radius: 12px;
  max-height: 300px;
  overflow-y: auto;
  display: none;
}

#playlist button {
  background: #222;
  margin: 5px;
  display: block;
  width: 100%;
  text-align: left;
}

#popup {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
#popupContent {
  background: var(--bg);
  color: var(--text);
  padding: 20px;
  border-radius: 12px;
  text-align: center;
}
#popup button {
  margin-top: 10px;
}

@keyframes fadeInDown {
  0% { transform: translateY(-20px); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

  </style>
</head>
<body>
  <h1>ðŸš€ IPTV Player with Playlist & Format Support</h1>  <div class="controls">
    <input type="text" id="streamUrl" placeholder="Enter Stream URL (.m3u8, .mp4...)" />
    <input type="text" id="playlistUrl" placeholder="Or enter Playlist URL (.m3u)" />
    <input type="file" id="playlistFile" accept=".m3u,.txt" />
    <button onclick="loadStream()">â–¶ Play</button>
    <button onclick="togglePlaylist()">ðŸ“ƒ Show Playlist</button>
    <button onclick="toggleTheme()">ðŸŒ“ Toggle Theme</button>
    <button onclick="enterPip()">ðŸ“º PiP Mode</button>
  </div>  <media-theme-yt id="mediaWrapper">
    <hls-video id="hlsPlayer" slot="media" controls crossorigin="anonymous" playsinline></hls-video>
  </media-theme-yt>
  <video id="fallbackPlayer" controls style="display:none;"></video>  <div id="playlist"></div>  <div id="popup">
    <div id="popupContent">
      <p>Join our Telegram channel for updates & premium links!</p>
      <button onclick="window.open('https://t.me/IPTVM3Y','_blank')">Join Now</button>
      <button onclick="document.getElementById('popup').style.display='none'">Cancel</button>
    </div>
  </div>  <script>
    const hlsPlayer = document.getElementById("hlsPlayer");
    const fallbackPlayer = document.getElementById("fallbackPlayer");
    const streamInput = document.getElementById("streamUrl");
    const playlistInput = document.getElementById("playlistUrl");
    const playlistDiv = document.getElementById("playlist");
    const fileInput = document.getElementById("playlistFile");

    function loadStream(url = null) {
      const streamUrl = url || streamInput.value.trim();
      if (!streamUrl) return alert("Enter a valid stream URL");
      if (streamUrl.endsWith(".m3u8")) {
        fallbackPlayer.style.display = "none";
        hlsPlayer.style.display = "block";
        hlsPlayer.src = streamUrl;
      } else {
        hlsPlayer.style.display = "none";
        fallbackPlayer.style.display = "block";
        fallbackPlayer.src = streamUrl;
        fallbackPlayer.play();
      }
    }

    function togglePlaylist() {
      playlistDiv.style.display = playlistDiv.style.display === "none" ? "block" : "none";
    }

    fileInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (event) => {
        const lines = event.target.result.split(/\r?\n/).filter(l => l && !l.startsWith("#"));
        populatePlaylist(lines);
      };
      reader.readAsText(file);
    });

    playlistInput.addEventListener("change", () => {
      const url = playlistInput.value.trim();
      if (!url) return;
      fetch(url)
        .then(res => res.text())
        .then(text => {
          const lines = text.split(/\r?\n/).filter(l => l && !l.startsWith("#"));
          populatePlaylist(lines);
        })
        .catch(() => alert("Failed to load playlist URL"));
    });

    function populatePlaylist(lines) {
      playlistDiv.innerHTML = "";
      lines.forEach((line, i) => {
        const btn = document.createElement("button");
        btn.textContent = `Channel ${i + 1}`;
        btn.onclick = () => loadStream(line);
        playlistDiv.appendChild(btn);
      });
    }

    function toggleTheme() {
      const html = document.documentElement;
      html.dataset.theme = html.dataset.theme === 'light' ? 'dark' : 'light';
    }

    function enterPip() {
      const player = hlsPlayer.style.display !== 'none' ? hlsPlayer : fallbackPlayer;
      if (player.requestPictureInPicture) {
        player.requestPictureInPicture();
      } else {
        alert("Your browser doesn't support PiP");
      }
    }

    window.onload = () => {
      document.documentElement.dataset.theme = 'dark';
    };
  </script></body>
</html>
